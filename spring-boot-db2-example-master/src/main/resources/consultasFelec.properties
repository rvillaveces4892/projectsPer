#consultaAceptacionTacito=SELECT MAX( p.id_accion ) AS idAccion,p.no_documento AS nroDocumento,p.num_resolu_dian AS resDian,p.identificacion_obligado AS idObligado,p.fecha_accion AS fechAccion,p.id_usuario AS idUsuario,p.id_tipo_doc_fe AS idTipoDoc,p.identificacion_adquiriente AS idAdquiriente FROM felecv3.movimiento_doc_fe p GROUP BY p.no_documento,p.num_resolu_dian,p.identificacion_obligado,p.fecha_accion, p.id_usuario,p.id_tipo_doc_fe,p.identificacion_adquiriente HAVING MAX( p.id_accion )= 5 UNION SELECT MAX( p.id_accion ) AS idAccion,p.no_documento AS nroDocumento,p.num_resolu_dian AS resDian,p.identificacion_obligado AS idObligado,p.fecha_accion AS fechAccion,	p.id_usuario AS idUsuario,p.id_tipo_doc_fe AS idTipoDoc,p.identificacion_adquiriente AS idAdquiriente FROM felecv3.movimiento_doc_fe p GROUP BY p.no_documento,p.num_resolu_dian,p.identificacion_obligado,p.fecha_accion,p.id_usuario,p.id_tipo_doc_fe,p.identificacion_adquiriente HAVING MAX( p.id_accion )= 11
consultaAceptacionTacito=SELECT DOCUMENTO4.ID_ESTADO AS idAccion, AUD.IDENTIFICACION_OBLIGADO AS idObligado,AUD.NO_DOCUMENTO AS nroDocumento,AUD.ID_TIPO_DOC as idTipoDoc,AUD.NUM_RESOLU_DIAN AS resDian,DOCUMENTO4.IDENTIFICACION_ADQUIRIENTE AS idAdquiriente FROM (SELECT IDENTIFICACION_OBLIGADO,NO_DOCUMENTO,ID_TIPO_DOC,NUM_RESOLU_DIAN FROM FELECV3.AUDITORIA_DATA_DOC WHERE CODIGO_TRANS_XML=200 AND FECHA_TRANS_XML<DATE(DAYS(CURRENT_DATE)-3)) AS AUD INNER JOIN FELECV3.DOCUMENTO_FE AS DOCUMENTO4 ON DOCUMENTO4.NO_DOCUMENTO=AUD.NO_DOCUMENTO AND DOCUMENTO4.IDENTIFICACION_OBLIGADO =AUD.IDENTIFICACION_OBLIGADO AND DOCUMENTO4.NUM_RESOLU_DIAN =AUD.NUM_RESOLU_DIAN AND DOCUMENTO4.ID_TIPO_DOC_FE =AUD.ID_TIPO_DOC WHERE DOCUMENTO4.ID_ESTADO<>3 AND DOCUMENTO4.ID_ESTADO<>4 AND DOCUMENTO4.ID_ESTADO<>6 FETCH FIRST 500 ROWS ONLY WITH UR
ActualizacionDocFeTacito=UPDATE FELECV3.DOCUMENTO_FE FACT SET FACT.ID_ESTADO=? WHERE FACT.IDENTIFICACION_OBLIGADO=? AND FACT.NO_DOCUMENTO = ? AND FACT.NUM_RESOLU_DIAN = ? AND FACT.IDENTIFICACION_ADQUIRIENTE = ?
insertaMovDocFe=INSERT INTO felecv3.movimiento_doc_fe(no_documento,fecha_accion,id_accion,comentario_accion,id_usuario,id_tipo_doc_fe,identificacion_obligado,identificacion_adquiriente,num_resolu_dian) VALUES (?,CURRENT_TIMESTAMP,?,?,?,?,?,?,?)
consultaMailAdquiriente=SELECT da.email AS mailAdquiriente FROM felecv3.dato_documento_adquiriente da WHERE da.identificacion_obligado\=? AND da.no_documento\=? AND da.num_resolu_dian\=?
#-----------Consulta principal ventana facturas emision--------------------------------
#Consulta que demora mucho cuando se sube mucho la cantidad de documentos en las tablas, se reemplaza por la que le sigue
#consultaDocumentos=SELECT D.NO_DOCUMENTO as documento, D.NUM_RESOLU_DIAN as numResolucion, D.FECHA_FACTURA as fechaFactura, D.VALOR_NETO_DOCUMENTO as valorFactura, AD.RAZON_SOCIAL as adquirienteFactura, (AD.NOMBRE_PN concat ' ' concat AD.NOMBRE2_PN concat ' ' concat AD.APELLIDO_PN) AS nombrePn, ED.DESCRIPCION as estadoFactura, (SELECT COUNT (*) FROM FELECV3.DATO_ENVIO_FE DE WHERE DE.NO_DOCUMENTO\=D.NO_DOCUMENTO) AS enviosFactura, D.ID_TIPO_DOC_FE AS tipoDocumento, D.IDENTIFICACION_ADQUIRIENTE AS nitAdquiriente, D.IDENTIFICACION_OBLIGADO AS idObligado FROM FELECV3.DOCUMENTO_FE D INNER JOIN FELECV3.OFE_ADQUIRIENTE AD ON D.IDENTIFICACION_ADQUIRIENTE \= AD.IDENTIFICACION_ADQUIRIENTE AND D.IDENTIFICACION_OBLIGADO \= AD.IDENTIFICACION_OBLIGADO INNER JOIN FELECV3.ESTADO_DOCUMENTO_FE ED ON D.ID_ESTADO\=ED.ID_ESTADO INNER JOIN FELECV3.AUDITORIA_DATA_DOC ADD ON D.NO_DOCUMENTO \= ADD.NO_DOCUMENTO AND D.IDENTIFICACION_OBLIGADO \= ADD.IDENTIFICACION_OBLIGADO AND D.NUM_RESOLU_DIAN \= ADD.NUM_RESOLU_DIAN WHERE D.FECHA_FACTURA BETWEEN '\:fechaInicio\:' AND '\:fechaFin\:' AND ADD.CODIGO_TRANS_XML \= 200
#consultaDocumentos=SELECT D.NO_DOCUMENTO as documento,D.NUM_RESOLU_DIAN as numResolucion,D.FECHA_FACTURA as fechaFactura,D.VALOR_NETO_DOCUMENTO as valorFactura,AD.RAZON_SOCIAL as adquirienteFactura,(AD.NOMBRE_PN concat ' ' concat AD.NOMBRE2_PN concat ' ' concat AD.APELLIDO_PN) AS nombrePn,ED.DESCRIPCION as estadoFactura,(SELECT COUNT (*) FROM FELECV3.DATO_ENVIO_FE DE WHERE DE.NO_DOCUMENTO\=D.NO_DOCUMENTO) AS enviosFactura,D.ID_TIPO_DOC_FE AS tipoDocumento,D.IDENTIFICACION_ADQUIRIENTE AS nitAdquiriente,D.IDENTIFICACION_OBLIGADO AS idObligado FROM ((SELECT * FROM FELECV3.AUDITORIA_DATA_DOC WHERE CODIGO_TRANS_XML \= 200 AND FECHA_CARGUE_DATA BETWEEN ':fechaInicio:' AND ':fechaFin:' \:andIdObligado\: :filtro: FETCH FIRST 300 ROWS ONLY) AS ADD INNER JOIN FELECV3.DOCUMENTO_FE D ON ADD.NO_DOCUMENTO \= D.NO_DOCUMENTO AND ADD.IDENTIFICACION_OBLIGADO \= D.IDENTIFICACION_OBLIGADO AND ADD.NUM_RESOLU_DIAN \= D.NUM_RESOLU_DIAN AND ADD.ID_TIPO_DOC \= D.ID_TIPO_DOC_FE INNER JOIN FELECV3.ESTADO_DOCUMENTO_FE ED ON D.ID_ESTADO\=ED.ID_ESTADO INNER JOIN FELECV3.OFE_ADQUIRIENTE AD ON D.IDENTIFICACION_ADQUIRIENTE \= AD.IDENTIFICACION_ADQUIRIENTE AND D.IDENTIFICACION_OBLIGADO \= AD.IDENTIFICACION_OBLIGADO) WHERE D.FECHA_FACTURA BETWEEN '\:fechaInicio\:' AND '\:fechaFin\:'
consultaDocumentos=SELECT D.NO_DOCUMENTO as documento, D.NUM_RESOLU_DIAN as numResolucion, D.FECHA_FACTURA as fechaFactura, D.VALOR_NETO_DOCUMENTO as valorFactura, AD.RAZON_SOCIAL as adquirienteFactura, (AD.NOMBRE_PN concat ' ' concat AD.NOMBRE2_PN concat ' ' concat AD.APELLIDO_PN) AS nombrePn, ED.DESCRIPCION as estadoFactura, (SELECT COUNT (*) FROM FELECV3.DATO_ENVIO_FE DE WHERE DE.NO_DOCUMENTO=D.NO_DOCUMENTO) AS enviosFactura, D.ID_TIPO_DOC_FE AS tipoDocumento, D.IDENTIFICACION_ADQUIRIENTE AS nitAdquiriente, D.IDENTIFICACION_OBLIGADO AS idObligado FROM ( ( SELECT * FROM FELECV3.DOCUMENTO_FE WHERE FECHA_FACTURA BETWEEN ':fechaInicio:' AND ':fechaFin:' :andIdObligado: :whereBase: FETCH FIRST 800 ROWS ONLY ) AS D INNER JOIN FELECV3.AUDITORIA_DATA_DOC ADD ON ADD.NO_DOCUMENTO = D.NO_DOCUMENTO AND ADD.IDENTIFICACION_OBLIGADO = D.IDENTIFICACION_OBLIGADO AND ADD.NUM_RESOLU_DIAN = D.NUM_RESOLU_DIAN AND ADD.ID_TIPO_DOC = D.ID_TIPO_DOC_FE INNER JOIN FELECV3.ESTADO_DOCUMENTO_FE ED ON D.ID_ESTADO=ED.ID_ESTADO INNER JOIN FELECV3.OFE_ADQUIRIENTE AD ON D.IDENTIFICACION_ADQUIRIENTE = AD.IDENTIFICACION_ADQUIRIENTE AND D.IDENTIFICACION_OBLIGADO = AD.IDENTIFICACION_OBLIGADO ) WHERE ADD.GENERO_XML = 1 :orderBy:
consultaDocumentosFiltros = SELECT D.NO_DOCUMENTO as documento, D.NUM_RESOLU_DIAN as numResolucion, D.FECHA_FACTURA as fechaFactura,D.VALOR_NETO_DOCUMENTO as valorFactura,AD.RAZON_SOCIAL as adquirienteFactura,(AD.NOMBRE_PN concat ' ' concat AD.NOMBRE2_PN concat ' ' concat AD.APELLIDO_PN) AS nombrePn, ED.DESCRIPCION as estadoFactura,(SELECT COUNT (*) FROM FELECV3.DATO_ENVIO_FE DE WHERE DE.NO_DOCUMENTO=D.NO_DOCUMENTO) AS enviosFactura,D.ID_TIPO_DOC_FE AS tipoDocumento,D.IDENTIFICACION_ADQUIRIENTE AS nitAdquiriente,D.IDENTIFICACION_OBLIGADO AS idObligado FROM ((SELECT * FROM FELECV3.DOCUMENTO_FE :whereConsulta: ) AS D INNER JOIN FELECV3.AUDITORIA_DATA_DOC ADD ON ADD.NO_DOCUMENTO = D.NO_DOCUMENTO AND ADD.IDENTIFICACION_OBLIGADO = D.IDENTIFICACION_OBLIGADO   AND ADD.NUM_RESOLU_DIAN = D.NUM_RESOLU_DIAN   AND ADD.ID_TIPO_DOC = D.ID_TIPO_DOC_FE   INNER JOIN FELECV3.ESTADO_DOCUMENTO_FE ED ON D.ID_ESTADO=ED.ID_ESTADO   INNER JOIN FELECV3.OFE_ADQUIRIENTE AD ON D.IDENTIFICACION_ADQUIRIENTE = AD.IDENTIFICACION_ADQUIRIENTE   AND D.IDENTIFICACION_OBLIGADO = AD.IDENTIFICACION_OBLIGADO AND ADD.GENERO_XML = 1)
#--------------------------------------------------------------------------------------
consultEnvioNotificacion=SELECT EMAIL FROM FELECV3.OFE_ADQUIRIENTE WHERE IDENTIFICACION_OBLIGADO = ? AND IDENTIFICACION_ADQUIRIENTE = ? WITH UR
getFileNameXml=SELECT NOMBRE_XML_DOC FROM FELECV3.AUDITORIA_DATA_DOC WHERE IDENTIFICACION_OBLIGADO \= ? AND NO_DOCUMENTO \= ? AND NUM_RESOLU_DIAN \= ? WITH UR
consultaMovDocumento=SELECT M.ID_MOVIMIENTO AS idMovimiento, M.NO_DOCUMENTO AS noDocumento, M.FECHA_ACCION AS fechaAccion, M.ID_ACCION AS idAccion, A.DESCRIPCION AS descripcionAccion, M.COMENTARIO_ACCION AS comentarioAccion, M.ID_USUARIO AS idUsuario, U.USUARIO AS usuario, DOC.IDENTIFICACION_ADQUIRIENTE AS nitAdquiriente, AD.RAZON_SOCIAL AS razonSocialAdquiriente, (AD.NOMBRE_PN concat ' ' concat AD.NOMBRE2_PN concat ' ' concat AD.APELLIDO_PN) AS nombrePn FROM FELECV3.MOVIMIENTO_DOC_FE M INNER JOIN FELECV3.ACCION_DOC_FE A ON M.ID_ACCION = A.ID_ACCION LEFT JOIN FELECV3.USUARIO_FELEC U ON M.ID_USUARIO = U.ID_USUARIO INNER JOIN FELECV3.DOCUMENTO_FE DOC ON M.NO_DOCUMENTO = DOC.NO_DOCUMENTO INNER JOIN FELECV3.OFE_ADQUIRIENTE AD ON DOC.IDENTIFICACION_ADQUIRIENTE = AD.IDENTIFICACION_ADQUIRIENTE AND DOC.IDENTIFICACION_OBLIGADO = AD.IDENTIFICACION_OBLIGADO WHERE M.NO_DOCUMENTO = ? :andIdObligado: AND M.ID_TIPO_DOC_FE =? :fechas: ORDER BY M.FECHA_ACCION DESC WITH UR
consultar_usuarios_compania=SELECT UF.ID_USUARIO AS idUsuario,UF.IDENTIFICACION_OBLIGADO AS identificacionObligado, UF.USUARIO AS usuario, UF.EMAIL AS email, UF.FECHA_CREACION AS fechaCreacion, UF.NOMBRE AS nombre, UF.IDENTIFICACION_ADQUIRIENTE AS identificacionAdquirente, UF.ID_ROL AS idRol, UF.ID_ESTADO_USUARIO AS idEstadoUsuario, UF.DIAS_CONSULTA AS diasConsulta FROM FELECV3.USUARIO_FELEC UF WHERE UF.IDENTIFICACION_OBLIGADO = ? OR UF.IDENTIFICACION_ADQUIRIENTE= ? :andStatement:
actualizar_usuario=UPDATE FELECV3.USUARIO_FELEC SET EMAIL \= ? , DIAS_CONSULTA \= ?, ID_ESTADO_USUARIO \= ?, ID_ROL \= ? WHERE USUARIO \= ?
eliminar_empresas_asociadas=DELETE FROM FELECV3.EMPRESA_ASOCIADA WHERE USUARIO \= ?
eliminar_usuario=DELETE FROM FELECV3.USUARIO_FELEC WHERE USUARIO \= ?
update_control_usuarios_interno=UPDATE FELECV3.CONTROL_USUARIOS SET NO_USUARIO_INTERNO = NO_USUARIO_INTERNO +:factor_suma: WHERE ID_OBLIGADO = ?
update_control_usuarios_externo=UPDATE FELECV3.CONTROL_USUARIOS SET NO_USUARIO_EXTERNO = NO_USUARIO_EXTERNO +:factor_suma: WHERE ID_OBLIGADO = ?
consultarObligadoFe=SELECT IDENTIFICACION_OBLIGADO AS identificacionObligado,RAZON_SOCIAL AS razonSocial,EMAIL AS email,ID_ESTADO_OBLIGADO AS idEstadoObligado,ID_TIPO_PERSONA AS idTipoPersona,CODIGO_PAIS AS codigoPais,ID_TIPO_REGIMEN AS idTipoRegimen,ID_DOC_IDENTIFICACION AS idDocIdentificacion,DIRECCION AS direccion,CIUDAD AS ciudad,DEPARTAMENTO AS departamento,SUBDIVISION AS subdivision FROM FELECV3.OBLIGADO_FE WHERE IDENTIFICACION_OBLIGADO \= ? WITH UR
getControlUsuariosById=SELECT ID_CONTROL_USUARIOS FROM FELECV3.CONTROL_USUARIOS WHERE ID_OBLIGADO \= ? FETCH FIRST 1 ROWS ONLY WITH UR
insertUsuarioEmpresaAsociada=INSERT INTO FELECV3.EMPRESA_ASOCIADA(USUARIO, IDENTIFICACION_OBLIGADO, ID_GRUPO_EMPRESARIAL) VALUES (?,?,?)
selectAdqAutoCompletar=SELECT IDENTIFICACION_ADQUIRIENTE AS identificacionAdquiriente, RAZON_SOCIAL AS razonSocialAdq, NOMBRE_PN concat ' ' concat NOMBRE2_PN concat ' ' concat APELLIDO_PN AS nombrePn FROM FELECV3.OFE_ADQUIRIENTE \:condicional\: FETCH FIRST 10 ROWS ONLY
#selectAdqAutoCompletarByAdqObl=SELECT OA.IDENTIFICACION_ADQUIRIENTE AS identificacionAdquiriente, OA.RAZON_SOCIAL AS razonSocialAdq, OA.NOMBRE_PN concat ' ' concat OA.NOMBRE2_PN concat ' ' concat OA.APELLIDO_PN AS nombrePn FROM FELECV3.OFE_ADQUIRIENTE \:condicional\: INNER JOIN FELECV3.CONF_CARGA_OFE CCO ON OA.IDENTIFICACION_ADQUIRIENTE = CCO.IDENTIFICACION_OBLIGADO FETCH FIRST 10 ROWS ONLY
selectAdqAutoCompletarByAdqObl=SELECT identificacionAdquiriente,razonSocialAdq,nombrePn FROM (SELECT OA.IDENTIFICACION_ADQUIRIENTE AS identificacionAdquiriente, OA.RAZON_SOCIAL AS razonSocialAdq, OA.NOMBRE_PN concat ' ' concat OA.NOMBRE2_PN concat ' ' concat OA.APELLIDO_PN AS nombrePn FROM FELECV3.OFE_ADQUIRIENTE OA :condicional:) AS OFEADQ INNER JOIN FELECV3.CONF_CARGA_OFE CCO ON OFEADQ.identificacionAdquiriente = CAST (CCO.IDENTIFICACION_OBLIGADO AS VARCHAR(30))
#selectOblgAutoCompletarByObl=SELECT O.IDENTIFICACION_OBLIGADO AS identificacionObligado, O.RAZON_SOCIAL AS razonSocial FROM FELECV3.OFE_ADQUIRIENTE OA INNER JOIN FELECV3.OBLIGADO_FE O ON OA.IDENTIFICACION_OBLIGADO \= O.IDENTIFICACION_OBLIGADO \:condicional\: FETCH FIRST 10 ROWS ONLY 
selectOblgAutoCompletarByObl=SELECT identificacionObligado,razonSocial FROM (SELECT O.IDENTIFICACION_OBLIGADO AS identificacionObligado, O.RAZON_SOCIAL AS razonSocial FROM FELECV3.OFE_ADQUIRIENTE OA INNER JOIN FELECV3.OBLIGADO_FE O ON OA.IDENTIFICACION_OBLIGADO = O.IDENTIFICACION_OBLIGADO :condicional:) AS OBLIGADOS INNER JOIN FELECV3.CONF_CARGA_OFE CCO ON OBLIGADOS.identificacionObligado = CCO.IDENTIFICACION_OBLIGADO
findUserByUsername=SELECT {U.*} FROM FELECV3.USUARIO_FELEC U WHERE U.USUARIO = ? WITH UR
consultarAdquirienteFe=SELECT IDENTIFICACION_ADQUIRIENTE AS identificacionAdquiriente,IDENTIFICACION_OBLIGADO AS obligadoFe,IDENTIFICACION_OBLIGADO AS identificacionObligado,RAZON_SOCIAL AS razonSocialAdq,ID_TIPO_PERSONA AS tipoPersona,CODIGO_PAIS AS paisFe,ID_TIPO_REGIMEN AS tipoRegimenFe,ID_DOC_IDENTIFICACION AS tipoDocIdentificacion,DIRECCION AS direccion,CIUDAD AS ciudad,DEPARTAMENTO AS departamento,SUBDIVISION AS subdivision,EMAIL AS email,NOMBRE_PN AS nombrePn,NOMBRE2_PN AS nombre2Pn,APELLIDO_PN AS apellidoPn FROM FELECV3.OFE_ADQUIRIENTE AS OA WHERE IDENTIFICACION_ADQUIRIENTE = ? AND OA.IDENTIFICACION_OBLIGADO = ? WITH UR
consultarAdquirienteFeAll=SELECT IDENTIFICACION_ADQUIRIENTE AS identificacionAdquiriente,IDENTIFICACION_OBLIGADO AS obligadoFe,RAZON_SOCIAL AS razonSocialAdq,ID_TIPO_PERSONA AS tipoPersona,CODIGO_PAIS AS paisFe,ID_TIPO_REGIMEN AS tipoRegimenFe,ID_DOC_IDENTIFICACION AS tipoDocIdentificacion,DIRECCION AS direccion,CIUDAD AS ciudad,DEPARTAMENTO AS departamento,SUBDIVISION AS subdivision,EMAIL AS email,NOMBRE_PN AS nombrePn,NOMBRE2_PN AS nombre2Pn,APELLIDO_PN AS apellidoPn FROM FELECV3.OFE_ADQUIRIENTE WHERE IDENTIFICACION_OBLIGADO = ?
actualizarAdquiriente=UPDATE FELECV3.OFE_ADQUIRIENTE SET RAZON_SOCIAL = ?,ID_DOC_IDENTIFICACION = ?, EMAIL = ?, DEPARTAMENTO = ?, SUBDIVISION = ?, ID_TIPO_REGIMEN = ?, CODIGO_PAIS = ?, CIUDAD = ?, DIRECCION = ?,ID_TIPO_PERSONA = ? WHERE IDENTIFICACION_ADQUIRIENTE = ? AND IDENTIFICACION_OBLIGADO = ?
actualizarObligadoFe=UPDATE FELECV3.OBLIGADO_FE SET ID_TIPO_PERSONA \= ?,CODIGO_PAIS \= ?, ID_TIPO_REGIMEN \= ?, ID_DOC_IDENTIFICACION \= ?, DIRECCION \= ?, CIUDAD \= ?, DEPARTAMENTO \= ?, SUBDIVISION \= ?, ID_TIPO_RESOLUCION \= ?, EMAIL \= ? WHERE IDENTIFICACION_OBLIGADO \= ?
consultaNodoOfeDoc=SELECT NOD.NUM_RESOLU_DIAN AS numResoluDian, NOD.IDENTIFICACION_OBLIGADO AS identificacionObligado, NOD.ID_ESTADO_RESOLU AS idEstadoResolu, NOD.ID_PREFIJO AS idPrefijo ,NOD.RANGO_INI_NUM_DIAN AS rangoIniNumDian,NOD.RANGO_FIN_NUM_DIAN AS rangoFinNumDian,POR.VALOR_PREFIJO AS prefijo,FECHA_INI_RESOLU AS fechaIniResolu, FECHA_FIN_RESOLU AS fechaFinResolu from FELECV3.NODO_OBLIGADO_DOCUMENTO NOD INNER JOIN FELECV3.PREFIJO_OFE_RESOLUCION POR ON NOD.ID_PREFIJO \= POR.ID_PREFIJO WHERE NOD.IDENTIFICACION_OBLIGADO \= idObligadoP
consultarNodoObligadoDocumento=SELECT * FROM FELECV3.NODO_OBLIGADO_DOCUMENTO AS OA WHERE IDENTIFICACION_OBLIGADO = ? AND NUM_RESOLU_DIAN = ? AND ID_PREFIJO = ?
#GRUPO EMPRESARIAL
consultar_relacion_grupo_empresa=SELECT COUNT(*) FROM FELECV3.RELACION_GRUPO_EMPRESA WHERE ID_GRUPO_EMPRESARIAL = idGrupoEmpresarialP AND IDENTIFICACION_OBLIGADO = identificacionObligadoP
consultar_relacion_por_obligado=SELECT * FROM FELECV3.RELACION_GRUPO_EMPRESA WHERE IDENTIFICACION_OBLIGADO = ?
consultar_empresas_asociadas=SELECT of.RAZON_SOCIAL AS razonSocialCompania, rge.IDENTIFICACION_OBLIGADO AS identificacionObligado, ID_GRUPO_EMPRESARIAL AS idGrupoEmpresarial FROM FELECV3.RELACION_GRUPO_EMPRESA AS rge INNER JOIN FELECV2.OBLIGADO_FE AS of ON rge.IDENTIFICACION_OBLIGADO \= of.IDENTIFICACION_OBLIGADO WHERE rge.ID_GRUPO_EMPRESARIAL \= ?
consultar_empresas_adq_by_proveedor=SELECT OA.IDENTIFICACION_ADQUIRIENTE AS identificacionAdquiriente,OA.IDENTIFICACION_OBLIGADO AS identificacionObligado,OA.RAZON_SOCIAL AS razonSocialAdq,OA.ID_TIPO_PERSONA AS tipoPersona,OA.CODIGO_PAIS AS paisFe,OA.ID_TIPO_REGIMEN AS tipoRegimenFe,OA.ID_DOC_IDENTIFICACION AS tipoDocIdentificacion,OA.DIRECCION AS direccion,OA.CIUDAD AS ciudad,OA.DEPARTAMENTO AS departamento,OA.SUBDIVISION AS subdivision,OA.EMAIL AS email,OA.NOMBRE_PN AS nombrePn,OA.NOMBRE2_PN AS nombre2Pn,OA.APELLIDO_PN AS apellidoPn FROM FELECV3.OFE_ADQUIRIENTE AS OA WHERE OA.IDENTIFICACION_ADQUIRIENTE = ? AND OA.IDENTIFICACION_OBLIGADO = ?
#REPORTE RADICACION
consultarFacturasExpedidasPorFecha=SELECT D.IDENTIFICACION_ADQUIRIENTE AS nitAdquiriente, COUNT(D.IDENTIFICACION_ADQUIRIENTE) AS cantidad, sum(D.VALOR_NETO_DOCUMENTO) as totalValor FROM FELECV3.DOCUMENTO_FE D WHERE D.IDENTIFICACION_OBLIGADO = :nitObligado: AND D.FECHA_FACTURA BETWEEN ':fechaInicio:' AND ':fechaFin:' AND ID_TIPO_DOC_FE = 1 AND D.ID_ESTADO != 5 GROUP BY D.IDENTIFICACION_ADQUIRIENTE
consultarFacturasAnuladasPorFecha=SELECT D.IDENTIFICACION_ADQUIRIENTE AS nitAdquiriente, COUNT(D.IDENTIFICACION_ADQUIRIENTE) AS cantidad, sum(D.VALOR_NETO_DOCUMENTO) as totalValor FROM FELECV3.DOCUMENTO_FE D WHERE D.IDENTIFICACION_OBLIGADO = :nitObligado: AND D.FECHA_FACTURA BETWEEN ':fechaInicio:' AND ':fechaFin:' AND D.ID_TIPO_DOC_FE = 2 AND D.ID_ESTADO != 5 GROUP BY D.IDENTIFICACION_ADQUIRIENTE
consultarNotasCreditoPorFecha=SELECT D.IDENTIFICACION_ADQUIRIENTE AS nitAdquiriente, COUNT(D.IDENTIFICACION_ADQUIRIENTE) AS cantidad, sum(D.VALOR_NETO_DOCUMENTO) as totalValor FROM FELECV3.DOCUMENTO_FE D WHERE D.IDENTIFICACION_OBLIGADO = :nitObligado: AND D.FECHA_FACTURA BETWEEN ':fechaInicio:' AND ':fechaFin:' AND D.ID_ESTADO = 5 GROUP BY D.IDENTIFICACION_ADQUIRIENTE
consultarFacturasPorFecha=SELECT D.IDENTIFICACION_ADQUIRIENTE AS nitAdquiriente, COUNT(D.IDENTIFICACION_ADQUIRIENTE) AS cantidad, sum(D.VALOR_NETO_DOCUMENTO) as totalValor, ADQ.RAZON_SOCIAL AS razonSocialAdq FROM FELECV3.DOCUMENTO_FE D INNER JOIN FELECV3.OFE_ADQUIRIENTE ADQ ON D.IDENTIFICACION_ADQUIRIENTE = ADQ.IDENTIFICACION_ADQUIRIENTE AND D.IDENTIFICACION_OBLIGADO = ADQ.IDENTIFICACION_OBLIGADO WHERE D.IDENTIFICACION_OBLIGADO = :nitObligado: AND D.FECHA_FACTURA BETWEEN ':fechaInicio:' AND ':fechaFin:' GROUP BY D.IDENTIFICACION_ADQUIRIENTE, ADQ.RAZON_SOCIAL
consultarFacturasDianAdq=SELECT D.IDENTIFICACION_OBLIGADO AS nitObligado, OBL.RAZON_SOCIAL AS razonSocialObl, COUNT(D.IDENTIFICACION_OBLIGADO) AS cantidad, sum(D.VALOR_NETO_DOCUMENTO) as totalValor FROM FELECV3.DOCUMENTO_FE D INNER JOIN FELECV3.OBLIGADO_FE OBL ON D.IDENTIFICACION_OBLIGADO = OBL.IDENTIFICACION_OBLIGADO WHERE D.IDENTIFICACION_OBLIGADO = :nitObligado: AND D.IDENTIFICACION_ADQUIRIENTE = ':nitAdquiriente:' AND D.ID_ESTADO = 3 AND D.FECHA_FACTURA BETWEEN ':fechaInicio:' AND ':fechaFin:' GROUP BY D.IDENTIFICACION_OBLIGADO, OBL.RAZON_SOCIAL
consultarAdqSinEnvioCorreo=SELECT ADD.IDENTIFICACION_OBLIGADO AS identificacionObligado, ADD.NO_DOCUMENTO AS numeroDocumento, ADD.NOMBRE_XML_DOC as nombreXmlDoc,ADD.ID_TIPO_DOC AS idTipoDoc, ADD.NUM_RESOLU_DIAN AS numResoluDian,ADD.VALOR_PREFIJO as valorPrefijo, DDA.IDENTIFICACION_ADQUIRIENTE AS identificacionAdquiriente,DDA.RAZON_SOCIAL AS razonSocial,DDA.DIRECCION AS direccion,DDA.CIUDAD AS ciudad,DDA.DEPARTAMENTO AS departamento,DDA.EMAIL as email,	DDA.NOMBRE_PN as nombrePn,DDA.NOMBRE2_PN as nombre2Pn,DDA.APELLIDO_PN as apellidoPn,DF.NO_REFERENCIA AS noReferencia,DF.FECHA_FACTURA AS fechaFactura,DF.VALOR_DOCUMENTO AS valorDocumento,DF.TOTAL_NETO as totalNeto,DF.BASE_EXCL_IVA as baseExclIva,DF.VALOR_NETO_DOCUMENTO as valorNetoDocumento,DF.cufe AS cufe,DF.FECHA_TRM as fechaTrm,DF.TRM as trm,DF.VALOR_NETO_DOC_MONEDA_EXT as valorNetoDocMonedaExt,DF.DESCRIPCION as descripcion,DF.BASE_GRAVABLE_IVA as baseGravableIva,DF.NUMERO_CUENTA as numeroCuenta,DF.NUMERO_PEDIDO as numeroPedido,DF.CANAL_VENTA as canalVenta,DF.REFE_PAGO as refePago,DF.FECHA_SUSPENSION as fechaSuspension,DF.FECHA_VENCIMIENTO as fechaVencimiento,DF.PERIODO_FACTURACION as periodoFacturacion,DF.OBSERVACIONES as observaciones,DF.TOTAL_IVA as totalIva,DF.TOTAL_DESCUENTO as totalDescuento,DF.COD_BARRAS as codBarras,DF.TOTAL_ICA as totalIca,DF.TOTAL_IMP_CONSUMO as totalImpConsumo,DF.TOTAL_CONTRIBUCIONES as totalContribuciones,DF.TOTAL_RTE_RENTA as totalRteRenta,DF.TOTAL_RTE_IVA as totalRteIva,DF.TOTAL_RTE_ICA as totalRteIca FROM  (SELECT add1.* FROM FELECV3.AUDITORIA_DATA_DOC ADD1 FETCH FIRST 2500 ROWS ONLY WITH UR) AS ADD LEFT OUTER JOIN (SELECT dda1.* FROM FELECV3.DATO_DOCUMENTO_ADQUIRIENTE dda1 FETCH FIRST 2500 ROWS ONLY WITH UR) AS DDA ON ADD.IDENTIFICACION_OBLIGADO = DDA.IDENTIFICACION_OBLIGADO AND ADD.NO_DOCUMENTO = DDA.NO_DOCUMENTO AND ADD.NUM_RESOLU_DIAN = DDA.NUM_RESOLU_DIAN AND ADD.ID_TIPO_DOC = DDA.ID_TIPO_DOC LEFT OUTER JOIN (SELECT df1.* FROM FELECV3.DOCUMENTO_FE df1 FETCH FIRST 2500 ROWS ONLY WITH UR) AS DF ON DF.IDENTIFICACION_OBLIGADO = ADD.IDENTIFICACION_OBLIGADO AND DF.NO_DOCUMENTO = ADD.NO_DOCUMENTO AND DF.NUM_RESOLU_DIAN = ADD.NUM_RESOLU_DIAN AND DF.ID_TIPO_DOC_FE = ADD.ID_TIPO_DOC INNER JOIN ENVIO_SELECT.CONF_ENVIO_OBLIGADO ceo ON ceo.identificacion_obligado = ADD.identificacion_obligado AND ceo.num_resolu_dian = ADD.num_resolu_dian  AND ceo.id_tipo_doc_fe = ADD.id_tipo_doc WHERE ADD.ENVIO_MAIL_XML = 0 AND ADD.GENERO_XML = 1 AND ADD.CODIGO_TRANS_XML = 200 FETCH FIRST 2500 ROWS ONLY WITH UR
actualizarEstadoEnvioXmlAdq=UPDATE FELECV3.AUDITORIA_DATA_DOC as add SET ENVIO_MAIL_XML \= ? WHERE ADD.IDENTIFICACION_OBLIGADO \= ? AND ADD.NO_DOCUMENTO \= ? AND ADD.ID_TIPO_DOC \= ? AND ADD.NUM_RESOLU_DIAN \= ?
consultarAdqSinEnvioCorreoV2=SELECT ADD.identificacion_obligado AS identificacionObligado, ADD.no_documento AS numeroDocumento,ADD.nombre_xml_doc AS nombreXmlDoc, ADD.id_tipo_doc AS idTipoDoc, ADD.num_resolu_dian AS numResoluDian, ADD.valor_prefijo AS valorPrefijo, DDA.identificacion_adquiriente AS identificacionAdquiriente, DDA.razon_social AS razonSocial,DDA.direccion AS direccion, DDA.ciudad AS ciudad, DDA.departamento AS departamento, DDA.email AS email, DDA.nombre_pn AS nombrePn,DDA.nombre2_pn AS nombre2Pn, DDA.apellido_pn AS apellidoPn, DF.no_referencia AS noReferencia, DF.fecha_factura AS fechaFactura,DF.valor_documento AS valorDocumento, DF.total_neto AS totalNeto, DF.base_excl_iva AS baseExclIva,DF.valor_neto_documento AS valorNetoDocumento, DF.cufe AS cufe,DF.fecha_trm AS fechaTrm, DF.trm AS trm, DF.valor_neto_doc_moneda_ext AS valorNetoDocMonedaExt, DF.descripcion AS descripcion, DF.base_gravable_iva AS baseGravableIva, DF.numero_cuenta AS numeroCuenta, DF.numero_pedido AS numeroPedido, DF.canal_venta AS canalVenta, DF.refe_pago AS refePago, DF.fecha_suspension AS fechaSuspension, DF.fecha_vencimiento AS fechaVencimiento, DF.periodo_facturacion AS periodoFacturacion, DF.observaciones AS observaciones, DF.total_iva AS totalIva, DF.total_descuento AS totalDescuento, DF.cod_barras AS codBarras, DF.total_ica AS totalIca, DF.total_imp_consumo AS totalImpConsumo, DF.total_contribuciones AS totalContribuciones, DF.total_rte_renta AS totalRteRenta, DF.total_rte_iva AS totalRteIva, DF.total_rte_ica AS totalRteIca FROM felecv3.auditoria_data_doc ADD inner join felecv3.dato_documento_adquiriente DDA ON ADD.identificacion_obligado = DDA.identificacion_obligado AND ADD.no_documento = DDA.no_documento AND ADD.num_resolu_dian = DDA.num_resolu_dian AND ADD.id_tipo_doc = DDA.id_tipo_doc INNER join felecv3.documento_fe DF ON DF.identificacion_obligado = ADD.identificacion_obligado AND DF.no_documento = ADD.no_documento AND DF.num_resolu_dian = ADD.num_resolu_dian AND DF.id_tipo_doc_fe = ADD.id_tipo_doc inner join envio_select.conf_envio_obligado ceo ON ceo.identificacion_obligado = ADD.identificacion_obligado  AND ceo.num_resolu_dian = ADD.num_resolu_dian AND ceo.id_tipo_doc_fe = ADD.id_tipo_doc AND ceo.id_prefijo = 1 AND ceo.id_tipo_envio = 1 WHERE  ADD.envio_mail_xml = 0 AND ADD.genero_xml = 1 AND ADD.CODIGO_TRANS_XML = 200 AND ADD.ID_ESTADO_CARGA_DOC = 3 FETCH FIRST 1500 ROWS ONLY WITH UR
consultarAdqSinEnvioCorreoV3=SELECT ADD.identificacion_obligado AS identificacionObligado, ADD.no_documento AS numeroDocumento,ADD.nombre_xml_doc AS nombreXmlDoc, ADD.id_tipo_doc AS idTipoDoc, ADD.num_resolu_dian AS numResoluDian, ADD.valor_prefijo AS valorPrefijo, DDA.identificacion_adquiriente AS identificacionAdquiriente, DDA.razon_social AS razonSocial,DDA.direccion AS direccion, DDA.ciudad AS ciudad, DDA.departamento AS departamento, DDA.email AS email, DDA.nombre_pn AS nombrePn,DDA.nombre2_pn AS nombre2Pn, DDA.apellido_pn AS apellidoPn, DF.no_referencia AS noReferencia, DF.fecha_factura AS fechaFactura,DF.valor_documento AS valorDocumento, DF.total_neto AS totalNeto, DF.base_excl_iva AS baseExclIva,DF.valor_neto_documento AS valorNetoDocumento, DF.cufe AS cufe,DF.fecha_trm AS fechaTrm, DF.trm AS trm, DF.valor_neto_doc_moneda_ext AS valorNetoDocMonedaExt, DF.descripcion AS descripcion, DF.base_gravable_iva AS baseGravableIva, DF.numero_cuenta AS numeroCuenta, DF.numero_pedido AS numeroPedido, DF.canal_venta AS canalVenta, DF.refe_pago AS refePago, DF.fecha_suspension AS fechaSuspension, DF.fecha_vencimiento AS fechaVencimiento, DF.periodo_facturacion AS periodoFacturacion, DF.observaciones AS observaciones, DF.total_iva AS totalIva, DF.total_descuento AS totalDescuento, DF.cod_barras AS codBarras, DF.total_ica AS totalIca, DF.total_imp_consumo AS totalImpConsumo, DF.total_contribuciones AS totalContribuciones, DF.total_rte_renta AS totalRteRenta, DF.total_rte_iva AS totalRteIva, DF.total_rte_ica AS totalRteIca, ADD.envejecimiento_email AS envejecimientoMail FROM felecv3.auditoria_data_doc ADD inner join felecv3.dato_documento_adquiriente DDA ON ADD.identificacion_obligado = DDA.identificacion_obligado AND ADD.no_documento = DDA.no_documento AND ADD.num_resolu_dian = DDA.num_resolu_dian AND ADD.id_tipo_doc = DDA.id_tipo_doc INNER join felecv3.documento_fe DF ON DF.identificacion_obligado = ADD.identificacion_obligado AND DF.no_documento = ADD.no_documento AND DF.num_resolu_dian = ADD.num_resolu_dian AND DF.id_tipo_doc_fe = ADD.id_tipo_doc inner join envio_select.conf_envio_obligado ceo ON ceo.identificacion_obligado = ADD.identificacion_obligado  AND ceo.num_resolu_dian = ADD.num_resolu_dian AND ceo.id_tipo_doc_fe = ADD.id_tipo_doc AND ceo.id_prefijo = 1 AND ceo.id_tipo_envio = 1 WHERE  ADD.envio_mail_xml = 0 AND ADD.genero_xml = 1 AND ADD.CODIGO_TRANS_XML = 200 ORDER BY ENVEJECIMIENTO_EMAIL ASC FETCH FIRST 1500 ROWS ONLY WITH UR
consultarAdqSinEnvioCorreoV4=SELECT SUBSTRING(ID_CANAL_ENVIO,2,1,OCTETS) AS canalEnvio, ADD.identificacion_obligado AS identificacionObligado, ADD.no_documento AS numeroDocumento,ADD.nombre_xml_doc AS nombreXmlDoc, ADD.id_tipo_doc AS idTipoDoc, ADD.num_resolu_dian AS numResoluDian, ADD.valor_prefijo AS valorPrefijo, DDA.identificacion_adquiriente AS identificacionAdquiriente, DDA.razon_social AS razonSocial,DDA.direccion AS direccion, DDA.ciudad AS ciudad, DDA.departamento AS departamento, DDA.email AS email, DDA.nombre_pn AS nombrePn,DDA.nombre2_pn AS nombre2Pn, DDA.apellido_pn AS apellidoPn, DF.no_referencia AS noReferencia, DF.fecha_factura AS fechaFactura,DF.valor_documento AS valorDocumento, DF.total_neto AS totalNeto, DF.base_excl_iva AS baseExclIva,DF.valor_neto_documento AS valorNetoDocumento, DF.cufe AS cufe,DF.fecha_trm AS fechaTrm, DF.trm AS trm, DF.valor_neto_doc_moneda_ext AS valorNetoDocMonedaExt, DF.descripcion AS descripcion, DF.base_gravable_iva AS baseGravableIva, DF.numero_cuenta AS numeroCuenta, DF.numero_pedido AS numeroPedido, DF.canal_venta AS canalVenta, DF.refe_pago AS refePago, DF.fecha_suspension AS fechaSuspension, DF.fecha_vencimiento AS fechaVencimiento, DF.periodo_facturacion AS periodoFacturacion, DF.observaciones AS observaciones, DF.total_iva AS totalIva, DF.total_descuento AS totalDescuento, DF.cod_barras AS codBarras, DF.total_ica AS totalIca, DF.total_imp_consumo AS totalImpConsumo, DF.total_contribuciones AS totalContribuciones, DF.total_rte_renta AS totalRteRenta, DF.total_rte_iva AS totalRteIva, DF.total_rte_ica AS totalRteIca, ADD.envejecimiento_email AS envejecimientoMail FROM felecv3.auditoria_data_doc ADD inner join felecv3.dato_documento_adquiriente DDA ON ADD.identificacion_obligado = DDA.identificacion_obligado AND ADD.no_documento = DDA.no_documento AND ADD.num_resolu_dian = DDA.num_resolu_dian AND ADD.id_tipo_doc = DDA.id_tipo_doc INNER join felecv3.documento_fe DF ON DF.identificacion_obligado = ADD.identificacion_obligado AND DF.no_documento = ADD.no_documento AND DF.num_resolu_dian = ADD.num_resolu_dian AND DF.id_tipo_doc_fe = ADD.id_tipo_doc inner join envio_select.conf_envio_obligado ceo ON ceo.identificacion_obligado = ADD.identificacion_obligado  AND ceo.num_resolu_dian = ADD.num_resolu_dian AND ceo.id_tipo_doc_fe = ADD.id_tipo_doc AND ceo.id_prefijo = 1 AND ceo.id_tipo_envio = 1 WHERE  ADD.envio_mail_xml = 0 AND ADD.genero_xml = 1 AND ADD.CODIGO_TRANS_XML = 200 ORDER BY ENVEJECIMIENTO_EMAIL ASC FETCH FIRST 1500 ROWS ONLY WITH UR
consultarAdqSinEnvioCorreoV5=SELECT SUBSTRING(ID_CANAL_ENVIO,2,1,OCTETS) AS canalEnvio, ADD.identificacion_obligado AS identificacionObligado, ADD.no_documento AS numeroDocumento,ADD.nombre_xml_doc AS nombreXmlDoc, ADD.id_tipo_doc AS idTipoDoc, ADD.num_resolu_dian AS numResoluDian, ADD.valor_prefijo AS valorPrefijo, DDA.identificacion_adquiriente AS identificacionAdquiriente, DDA.razon_social AS razonSocial,DDA.direccion AS direccion, DDA.ciudad AS ciudad, DDA.departamento AS departamento, DDA.email AS email, DDA.nombre_pn AS nombrePn,DDA.nombre2_pn AS nombre2Pn, DDA.apellido_pn AS apellidoPn, DF.no_referencia AS noReferencia, DF.fecha_factura AS fechaFactura,DF.valor_documento AS valorDocumento, DF.total_neto AS totalNeto, DF.base_excl_iva AS baseExclIva,DF.valor_neto_documento AS valorNetoDocumento, DF.cufe AS cufe,DF.fecha_trm AS fechaTrm, DF.trm AS trm, DF.valor_neto_doc_moneda_ext AS valorNetoDocMonedaExt, DF.descripcion AS descripcion, DF.base_gravable_iva AS baseGravableIva, DF.numero_cuenta AS numeroCuenta, DF.numero_pedido AS numeroPedido, DF.canal_venta AS canalVenta, DF.refe_pago AS refePago, DF.fecha_suspension AS fechaSuspension, DF.fecha_vencimiento AS fechaVencimiento, DF.periodo_facturacion AS periodoFacturacion, DF.observaciones AS observaciones, DF.total_iva AS totalIva, DF.total_descuento AS totalDescuento, DF.cod_barras AS codBarras, DF.total_ica AS totalIca, DF.total_imp_consumo AS totalImpConsumo, DF.total_contribuciones AS totalContribuciones, DF.total_rte_renta AS totalRteRenta, DF.total_rte_iva AS totalRteIva, DF.total_rte_ica AS totalRteIca, ADD.envejecimiento_email AS envejecimientoMail, DF.CLAVE AS clave, DF.ASUNTO_ENVIO AS asuntoEnvio FROM felecv3.auditoria_data_doc ADD inner join felecv3.dato_documento_adquiriente DDA ON ADD.identificacion_obligado = DDA.identificacion_obligado AND ADD.no_documento = DDA.no_documento AND ADD.num_resolu_dian = DDA.num_resolu_dian AND ADD.id_tipo_doc = DDA.id_tipo_doc INNER join felecv3.documento_fe DF ON DF.identificacion_obligado = ADD.identificacion_obligado AND DF.no_documento = ADD.no_documento AND DF.num_resolu_dian = ADD.num_resolu_dian AND DF.id_tipo_doc_fe = ADD.id_tipo_doc inner join envio_select.conf_envio_obligado ceo ON ceo.identificacion_obligado = ADD.identificacion_obligado  AND ceo.num_resolu_dian = ADD.num_resolu_dian AND ceo.id_tipo_doc_fe = ADD.id_tipo_doc AND ceo.id_prefijo = 1 AND ceo.id_tipo_envio = 1 AND ceo.estado = 1 WHERE  ADD.envio_mail_xml = 0 AND ADD.genero_xml = 1 AND ADD.CODIGO_TRANS_XML = 200 ORDER BY ENVEJECIMIENTO_EMAIL ASC FETCH FIRST 1500 ROWS ONLY WITH UR
ejecutarActualizarAuditorias=UPDATE FELECV3.AUDITORIA_DATA_DOC as add SET ENVIO_MAIL_XML = 0 WHERE add.envio_mail_xml = -3 AND add.genero_xml = 1 AND add.codigo_trans_xml = 200 AND ((DAYS(CURRENT_DATE) - DAYS (DATE(add.FECHA_CARGUE_DATA)))<3)
#QUERYS_NUEVOS
insertRelacionGrupoEmp =INSERT INTO FELECV3.RELACION_GRUPO_EMPRESA(ID_GRUPO_EMPRESARIAL,IDENTIFICACION_OBLIGADO) VALUES (?,?)
getGrupoEmpresarialByName=SELECT {GE.*} FROM FELECV3.GRUPO_EMPRESARIAL GE WHERE NOMBRE_GRUPO_EMPRESARIAL \= ? FETCH FIRST 1 ROWS ONLY
getEmpresasAsociadasObligado=SELECT {RGE.*} FROM FELECV3.RELACION_GRUPO_EMPRESA RGE WHERE ID_GRUPO_EMPRESARIAL \= (SELECT ID_GRUPO_EMPRESARIAL FROM FELECV3.RELACION_GRUPO_EMPRESA WHERE IDENTIFICACION_OBLIGADO \= \:idObligado FETCH FIRST 1 ROWS ONLY)
obtenerUsuarioAdminSistema=SELECT * FROM FELECV3.USUARIO_FELEC as USUARIO_FELEC WHERE ID_ROL \= 4 and IDENTIFICACION_OBLIGADO \= 9006462511  FETCH FIRST 1 ROWS ONLY 
consultarDatosPlantilla=SELECT DDA.razon_social AS razonSocial, DDA.nombre_pn AS nombrePn, DDA.nombre2_pn AS nombre2Pn, DDA.apellido_pn AS apellidoPn, DF.fecha_factura AS fechaFactura, DF.valor_neto_documento AS valorNetoDocumento FROM felecv3.dato_documento_adquiriente DDA inner join felecv3.DOCUMENTO_FE DF ON DDA.IDENTIFICACION_OBLIGADO = DF.IDENTIFICACION_OBLIGADO AND DDA.NUM_RESOLU_DIAN = DF.NUM_RESOLU_DIAN AND DDA.ID_TIPO_DOC = DF.ID_TIPO_DOC_FE AND DDA.NO_DOCUMENTO = DF.NO_DOCUMENTO WHERE DDA.IDENTIFICACION_OBLIGADO = ? AND DDA.NUM_RESOLU_DIAN = ? AND DDA.ID_TIPO_DOC = ? AND DDA.NO_DOCUMENTO = ?